SELECT SQL_CALC_FOUND_ROWS products.*, IF(shared_descr.product_id IS NOT NULL, shared_descr.product, descr1.product) as product, IF(shared_prices.product_id IS NOT NULL,MIN(IF(shared_prices.percentage_discount = 0, shared_prices.price, shared_prices.price - (shared_prices.price * shared_prices.percentage_discount)/100)),MIN(IF(prices.percentage_discount = 0, prices.price, prices.price - (prices.price * prices.percentage_discount)/100))) as price, GROUP_CONCAT(IF(products_categories.link_type = 'M', CONCAT(products_categories.category_id, 'M'), products_categories.category_id)) as category_ids, products_categories.position, IF(shared_descr.product_id IS NOT NULL, shared_descr.short_description, descr1.short_description) as short_description, IF(shared_descr.product_id IS NOT NULL, IF(shared_descr.short_description = '', shared_descr.full_description, ''), IF(descr1.short_description = '', descr1.full_description, '')) as full_description, IF(shared_descr.product_id IS NOT NULL, shared_descr.meta_keywords, descr1.meta_keywords) as meta_keywords, IF(shared_descr.product_id IS NOT NULL, shared_descr.meta_description, descr1.meta_description) as meta_description, IF(shared_descr.product_id IS NOT NULL, shared_descr.search_words, descr1.search_words) as search_words, IF(shared_descr.product_id IS NOT NULL, shared_descr.promo_text, descr1.promo_text) as promo_text, AVG(cscart_discussion_rating.rating_value) AS average_rating, cscart_categories.id_path FROM cscart_products as products  LEFT JOIN cscart_product_descriptions as descr1 ON descr1.product_id = products.product_id AND descr1.lang_code = 'ru'  LEFT JOIN cscart_product_prices as prices ON prices.product_id = products.product_id AND prices.lower_limit = 1 INNER JOIN cscart_products_categories as products_categories ON products_categories.product_id = products.product_id INNER JOIN cscart_categories ON cscart_categories.category_id = products_categories.category_id  AND (cscart_categories.usergroup_ids = '' OR FIND_IN_SET(0, cscart_categories.usergroup_ids) OR FIND_IN_SET(2, cscart_categories.usergroup_ids) OR FIND_IN_SET(1, cscart_categories.usergroup_ids)) AND cscart_categories.status IN ('A', 'H')   LEFT JOIN cscart_ult_product_descriptions shared_descr ON shared_descr.product_id = products.product_id AND shared_descr.company_id = 1 AND shared_descr.lang_code = 'ru' LEFT JOIN cscart_ult_product_prices as shared_prices ON shared_prices.product_id = products.product_id AND shared_prices.lower_limit = 1  AND shared_prices.usergroup_id IN (0, 0, 2, 1) AND shared_prices.company_id = 1 LEFT JOIN cscart_discussion ON cscart_discussion.object_id = products.product_id AND cscart_discussion.object_type = 'P' AND cscart_discussion.company_id = 1 LEFT JOIN cscart_discussion_posts ON cscart_discussion_posts.thread_id = cscart_discussion.thread_id AND cscart_discussion_posts.status = 'A' LEFT JOIN cscart_discussion_rating ON cscart_discussion.thread_id = cscart_discussion_rating.thread_id AND cscart_discussion_rating.post_id = cscart_discussion_posts.post_id LEFT JOIN cscart_product_features_values AS feature_24 ON feature_24.product_id = products.product_id AND feature_24.feature_id = 24 AND feature_24.lang_code = 'ru' LEFT JOIN cscart_product_feature_variant_descriptions AS fvd_24 ON fvd_24.variant_id = feature_24.variant_id AND fvd_24.lang_code = 'ru'  LEFT JOIN cscart_product_features_values AS feature_25 ON feature_25.product_id = products.product_id AND feature_25.feature_id = 25 AND feature_25.lang_code = 'ru' LEFT JOIN cscart_product_features_values AS feature_20 ON feature_20.product_id = products.product_id AND feature_20.feature_id = 20 AND feature_20.lang_code = 'ru' LEFT JOIN cscart_product_features_values AS feature_22 ON feature_22.product_id = products.product_id AND feature_22.feature_id = 22 AND feature_22.lang_code = 'ru' LEFT JOIN cscart_product_feature_variant_descriptions AS fvd_22 ON fvd_22.variant_id = feature_22.variant_id AND fvd_22.lang_code = 'ru'  LEFT JOIN cscart_product_features_values AS feature_23 ON feature_23.product_id = products.product_id AND feature_23.feature_id = 23 AND feature_23.lang_code = 'ru' LEFT JOIN cscart_product_feature_variant_descriptions AS fvd_23 ON fvd_23.variant_id = feature_23.variant_id AND fvd_23.lang_code = 'ru'  WHERE 1  AND products.product_id NOT IN (247) AND cscart_categories.company_id = 1 AND (products.usergroup_ids = '' OR FIND_IN_SET(0, products.usergroup_ids) OR FIND_IN_SET(2, products.usergroup_ids) OR FIND_IN_SET(1, products.usergroup_ids)) AND products.status IN ('A') AND prices.usergroup_id IN (0, 0, 2, 1) AND fvd_24.variant >= 31.68  AND fvd_24.variant <= 32.32  AND IF(feature_25.variant_id IS NOT NULL, feature_25.variant_id, feature_25.value) = 141  AND IF(feature_20.variant_id IS NOT NULL, feature_20.variant_id, feature_20.value) = 136  AND fvd_22.variant >= 295.00  AND fvd_22.variant <= 305.00  AND fvd_23.variant >= 70.00  AND fvd_23.variant <= 74.00  GROUP BY products.product_id   ORDER BY price desc  LIMIT 0, 10